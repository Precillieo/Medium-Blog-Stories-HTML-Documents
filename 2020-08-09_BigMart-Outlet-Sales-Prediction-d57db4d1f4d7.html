<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>BigMart Outlet Sales Prediction</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">BigMart Outlet Sales Prediction</h1>
</header>
<section data-field="subtitle" class="p-summary">
The data scientists at BigMart have collected 2013 sales data for 1559 products across 10 stores in different cities. Also, certain…
</section>
<section data-field="body" class="e-content">
<section name="5f17" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c03e" id="c03e" class="graf graf--h3 graf--leading graf--title">BigMart Outlet Sales Prediction</h3><figure name="2303" id="2303" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*vj8FrKXxdPKhQSZl1EmXUA.jpeg" data-width="500" data-height="280" src="https://cdn-images-1.medium.com/max/800/1*vj8FrKXxdPKhQSZl1EmXUA.jpeg"></figure><p name="6baa" id="6baa" class="graf graf--p graf-after--figure">The data scientists at BigMart have collected 2013 sales data for 1559 products across 10 stores in different cities. Also, certain attributes of each product and store have been defined. The aim is to build a predictive model and predict the sales of each product at a particular outlet.</p><p name="4259" id="4259" class="graf graf--p graf-after--p">Using this model, BigMart will try to understand the properties of products and outlets which play a key role in increasing sales.</p><p name="289b" id="289b" class="graf graf--p graf-after--p">This article will acquaint you on everything you need to know in order to engage in hackathons/ competitions. It will take you through;</p><ul class="postList"><li name="8f6c" id="8f6c" class="graf graf--li graf-after--p">Data Loading</li><li name="04c8" id="04c8" class="graf graf--li graf-after--li">Data preprocessing</li><li name="8278" id="8278" class="graf graf--li graf-after--li">Feature engineering</li><li name="3120" id="3120" class="graf graf--li graf-after--li">Building a model</li><li name="bc08" id="bc08" class="graf graf--li graf-after--li">Making a submission</li></ul><p name="5819" id="5819" class="graf graf--p graf-after--li">I sense you are in a haste to learn!</p><h4 name="fbaf" id="fbaf" class="graf graf--h4 graf-after--p">Data Source</h4><p name="6945" id="6945" class="graf graf--p graf-after--h4">Datahack is one of the biggest data hackathon platforms for data scientists. <a href="https://datahack.analyticsvidhya.com/?utm_source=feed&amp;utm_medium=navbar" data-href="https://datahack.analyticsvidhya.com/?utm_source=feed&amp;utm_medium=navbar" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Here</a> is a link to join the competition. On the Analytics Vidhya platform, you can download your test file, train file, sample submissions and save them in a folder. Rename the test file as test.csv, train file as train.csv, sample submissions file as sample_submission.csv.</p><h4 name="0d46" id="0d46" class="graf graf--h4 graf-after--p">Data Loading</h4><figure name="9697" id="9697" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*pERlragV0jBo1AvCsnea1A.jpeg" data-width="683" data-height="188" src="https://cdn-images-1.medium.com/max/800/1*pERlragV0jBo1AvCsnea1A.jpeg"><figcaption class="imageCaption">Python libraries</figcaption></figure><p name="99c5" id="99c5" class="graf graf--p graf-after--figure">To have a neat notebook, I mostly import all my libraries and modules at the beginning of the code in the first cell of my Jupyter notebook.</p><p name="e006" id="e006" class="graf graf--p graf-after--p">Pandas is built on top of the NumPy package, meaning a lot of the structure of NumPy is used or replicated in Pandas.</p><p name="5f40" id="5f40" class="graf graf--p graf-after--p">Pandas is the most widely used tools for data mungling. It contains high-level data structures and manipulation tools designed to make data analysis fast and easy. Its&#39; features are mostly used extensively for loading data, renaming function, apply and apply map, making shape and columns, Unique functions, accessing sub data frames, plotting, groupby and statistics, aggregating functions, join, masking, handling missing values. But we are just going to get our hands on few of the pandas features.</p><figure name="1998" id="1998" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*a_kiUrAOGVXIBsUAo2k8ow.jpeg" data-width="683" data-height="286" src="https://cdn-images-1.medium.com/max/800/1*a_kiUrAOGVXIBsUAo2k8ow.jpeg"><figcaption class="imageCaption">Data loading</figcaption></figure><p name="bd86" id="bd86" class="graf graf--p graf-after--figure">When loading data with Pandas, the read_csv function is used for reading any delimited text file. We loaded in our already named <strong class="markup--strong markup--p-strong">train.csv</strong>, <strong class="markup--strong markup--p-strong">test.csv</strong> files, and set it to the names <strong class="markup--strong markup--p-strong">train_data</strong>, <strong class="markup--strong markup--p-strong">test_data</strong> respectively.</p><p name="fa88" id="fa88" class="graf graf--p graf-after--p">Printing the <strong class="markup--strong markup--p-strong">.shape</strong> of each of the data shows that the train_data constitutes about 12 columns, 8523 rows while the test_data constitutes 11 columns, 5681 rows. The train_data is 1 column more than the test_data due to the target column it contains.</p><figure name="8e98" id="8e98" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8CfzqusabwhPR_9-UJFdGw.jpeg" data-width="683" data-height="215" src="https://cdn-images-1.medium.com/max/800/1*8CfzqusabwhPR_9-UJFdGw.jpeg"><figcaption class="imageCaption">Data head</figcaption></figure><p name="fb0c" id="fb0c" class="graf graf--p graf-after--figure">The <strong class="markup--strong markup--p-strong">.head()</strong> function is used to get the first 5 rows. This function returns the first 5 rows for the object based on position. It is useful for quickly testing if your object has the right type of data.</p><figure name="ac6b" id="ac6b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WuWHxhLGVluDeryE9y3a3w.jpeg" data-width="683" data-height="272" src="https://cdn-images-1.medium.com/max/800/1*WuWHxhLGVluDeryE9y3a3w.jpeg"></figure><p name="2d38" id="2d38" class="graf graf--p graf-after--figure">The <strong class="markup--strong markup--p-strong">.info()</strong> function is used to print a concise summary of a DataFrame. This method prints information about a DataFrame including the index type and column types, non-null values, and memory usage.</p><p name="e02b" id="e02b" class="graf graf--p graf-after--p">On the DataHack platform, click on <strong class="markup--strong markup--p-strong">Problem statement</strong> &gt;&gt; <strong class="markup--strong markup--p-strong">Data Dictionary. </strong>There you will see the description and information on each of the variables.</p><figure name="95a3" id="95a3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*AFA5WjbiB3nN-icaZ2vxBw.jpeg" data-width="683" data-height="257" src="https://cdn-images-1.medium.com/max/800/1*AFA5WjbiB3nN-icaZ2vxBw.jpeg"></figure><p name="c226" id="c226" class="graf graf--p graf-after--figure">The <strong class="markup--strong markup--p-strong">.describe()</strong> method is used for calculating some statistical data like percentile, mean, and Std of the numerical values of the data frame. It analyzes both numeric and object series and also the data frame column sets of mixed data types. The <strong class="markup--strong markup--p-strong">Item_Outlet_Sales</strong> of our train_data is seen to have an average price of 2181, the maximum price of 13086, and minimum price of 33.29.</p><h4 name="cfa2" id="cfa2" class="graf graf--h4 graf-after--p">Data Pre-processing</h4><p name="5649" id="5649" class="graf graf--p graf-after--h4">Pre-processing refers to the transformations applied to our data before feeding it to the algorithm. Data Preprocessing is a technique that is used to convert the raw data into a clean data set.</p><ul class="postList"><li name="f994" id="f994" class="graf graf--li graf-after--p">Taking care Missing values</li><li name="fb49" id="fb49" class="graf graf--li graf-after--li">Dealing with Categorical Data</li><li name="0868" id="0868" class="graf graf--li graf-after--li">Normalization of Dataset for improved results</li></ul><figure name="a7cc" id="a7cc" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*M_XcFkrLDv6QurcoZXMmIw.jpeg" data-width="683" data-height="240" src="https://cdn-images-1.medium.com/max/800/1*M_XcFkrLDv6QurcoZXMmIw.jpeg"></figure><p name="8652" id="8652" class="graf graf--p graf-after--figure">The <strong class="markup--strong markup--p-strong">.isnull(). sum() </strong>will give the column-wise sum of missing values. This returns the counts of non-NA, NAN, and the total number of entries per group. Item_Weight column contains 1463 missing values, Outlet_Size column contains 2410 missing values. Likewise, the same columns in test_data but of different values.</p><figure name="8a35" id="8a35" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UWlOx_SZrytkfG5U-jmGbA.jpeg" data-width="683" data-height="365" src="https://cdn-images-1.medium.com/max/800/1*UWlOx_SZrytkfG5U-jmGbA.jpeg"></figure><p name="2df9" id="2df9" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">.value_counts()</strong> returns a Series containing counts of unique values. The resulting object will be in descending order so that the first element is the most frequently-occurring element. Excludes NA values by default. This has to be done in order to fill in our missing values correctly.</p><figure name="4a3b" id="4a3b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*AIE-0JzO19B7Vxd9US-qaw.jpeg" data-width="683" data-height="529" src="https://cdn-images-1.medium.com/max/800/1*AIE-0JzO19B7Vxd9US-qaw.jpeg"></figure><p name="e2db" id="e2db" class="graf graf--p graf-after--figure">The 3 cells in the image above illustrate how we intended to fill in the <strong class="markup--strong markup--p-strong">Item_Weight</strong> missing values with respect to the <strong class="markup--strong markup--p-strong">Item_Fat_Content</strong> values. The <strong class="markup--strong markup--p-strong">LF</strong>, <strong class="markup--strong markup--p-strong">Low Fat</strong>, <strong class="markup--strong markup--p-strong">low fat</strong> appears to be the same, so we added them together and set it to the name <strong class="markup--strong markup--p-strong">LOW</strong>. Similarly, the <strong class="markup--strong markup--p-strong">Regular</strong> and <strong class="markup--strong markup--p-strong">reg</strong> set to the name <strong class="markup--strong markup--p-strong">REG</strong>.</p><figure name="1a5b" id="1a5b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ScY_oQOWy9kgsvgBBNasWQ.jpeg" data-width="683" data-height="456" src="https://cdn-images-1.medium.com/max/800/1*ScY_oQOWy9kgsvgBBNasWQ.jpeg"></figure><p name="246e" id="246e" class="graf graf--p graf-after--figure">The Outlet_Size, with missing values, is taken care of by filling it with <strong class="markup--strong markup--p-strong">Medium</strong>(a value that appears most often), making use of the function <strong class="markup--strong markup--p-strong">fillna.</strong></p><p name="3534" id="3534" class="graf graf--p graf-after--p">The <strong class="markup--strong markup--p-strong">fillna()</strong> function is used to fill NA/NaN values using the specified method. Value to use to fill holes (e.g. 0). DataFrame of values specifying which value to use for a column in a DataFrame. Values not in the DataFrame will not be filled.</p><figure name="2416" id="2416" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*O8WB7TVUnLpAmUvJ98OBoQ.jpeg" data-width="683" data-height="427" src="https://cdn-images-1.medium.com/max/800/1*O8WB7TVUnLpAmUvJ98OBoQ.jpeg"></figure><p name="42d2" id="42d2" class="graf graf--p graf-after--figure">The <strong class="markup--strong markup--p-strong">Item_Identifier</strong> and the <strong class="markup--strong markup--p-strong">Outlet_Identifier</strong> seem to be redundant. However, we did a little feature engineering on the variables by summing up the two variables and setting them to one variable named Item_Outlet_Identifier.</p><p name="8ec1" id="8ec1" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">LabelEncoder</strong> can be used to normalize labels. It can also be used to transform non-numerical labels (as long as they are hashable and comparable) to numerical labels. LabelEncoder encodes labels with a value between 0 and n_classes-1 where n is the number of distinct labels. If a label repeats, it assigns the same value as assigned earlier.</p><p name="2e48" id="2e48" class="graf graf--p graf-after--p">We indeed used LabelEncoder on our categorical variables by assigning LabelEncoder to <strong class="markup--strong markup--p-strong">le</strong> and then using <strong class="markup--strong markup--p-strong">le.fit_transform</strong>.</p><figure name="33f5" id="33f5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*IR-EdAWzIgkZGiEuVoxVaw.jpeg" data-width="683" data-height="327" src="https://cdn-images-1.medium.com/max/800/1*IR-EdAWzIgkZGiEuVoxVaw.jpeg"></figure><p name="0146" id="0146" class="graf graf--p graf-after--figure">We then dropped the initially contrived Item and Outlet Identifier. We allotted the train and test data to a new name called train_new and test_new respectively.</p><h4 name="1ae9" id="1ae9" class="graf graf--h4 graf-after--p">Building a Model</h4><p name="81d0" id="81d0" class="graf graf--p graf-after--h4">Supervised learning shows the connection between two datasets: the observed data X and an external variable y that we are trying to predict, usually called “target” or “labels”.</p><p name="d200" id="d200" class="graf graf--p graf-after--p">All supervised estimators in scikit-learn implement a <strong class="markup--strong markup--p-strong">fit(X, y)</strong> method to fit the model and a <strong class="markup--strong markup--p-strong">predict(X)</strong> method that, given unlabeled observations X, returns the predicted labels y. The target value <strong class="markup--strong markup--p-strong">Item_Outlet_Sales</strong> is assigned to <strong class="markup--strong markup--p-strong">y, </strong>and we used the drop function to take the other values in our train_new data.</p><figure name="6f3d" id="6f3d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*FRKd-46gtxrPNxw2XtyBAQ.jpeg" data-width="683" data-height="208" src="https://cdn-images-1.medium.com/max/800/1*FRKd-46gtxrPNxw2XtyBAQ.jpeg"></figure><p name="ccc7" id="ccc7" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Train_test_split</em></strong> is a function in Sklearn model selection for splitting data arrays into two subsets: for training data and for testing data. With this function, you don’t need to divide the dataset manually. By default, Sklearn train_test_split will make random partitions for the two subsets.</p><p name="51f7" id="51f7" class="graf graf--p graf-after--p">The line <strong class="markup--strong markup--p-strong">test_size=0.2</strong> suggests that the test data should be 20% of the dataset and the rest should be train data. Then, we set the <strong class="markup--strong markup--p-strong">random_state</strong> to <strong class="markup--strong markup--p-strong">0.</strong></p><p name="3fc8" id="3fc8" class="graf graf--p graf-after--p">Model selection is the process of selecting one final machine learning mode from among a collection of candidate machine learning models for training dataset. Model selection is a process that can be applied both across different types of models (e.g. logistic regression, SVM, KNN e.t.c).</p><p name="e687" id="e687" class="graf graf--p graf-after--p">A good model will balance goodness of fit with simplicity. More complex models will be better able to adapt their shape to fit the data (for example, a fifth-order polynomial can exactly fit six points), but the additional parameters may not represent anything useful.</p><p name="5599" id="5599" class="graf graf--p graf-after--p">Nevertheless, while thinking of fitting the model with big brothers like Xgboost, CatBoost and the likes. My Linux based android phone couldn’t get them installed. Main reason I had the model fit with <strong class="markup--strong markup--p-strong">AdaBoostRegressor. </strong>The parameters <strong class="markup--strong markup--p-strong">n_estimators</strong> is equated to 50, <strong class="markup--strong markup--p-strong">learning_rate</strong> to 0.1 and <strong class="markup--strong markup--p-strong">random_state</strong> to default<strong class="markup--strong markup--p-strong">.</strong></p><p name="7a4b" id="7a4b" class="graf graf--p graf-after--p">Upon using .fit and .predict on our model. Fit function adjusts weights according to data values so that better accuracy can be achieved while the Predict function predicts the label of a new set of values.</p><p name="6037" id="6037" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">RMSE</strong> is an absolute measure of fit. As the square root of a variance, RMSE can be interpreted as the standard deviation of the unexplained variance, and has the useful property of being in the same units as the response variable. Lower values of RMSE indicate better fit. So our RMSE value is seen to be 1126.</p><h4 name="7dce" id="7dce" class="graf graf--h4 graf-after--p">Making a Submission</h4><figure name="beee" id="beee" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*nrmZaiCa6lOkHQa_Xp5mQw.jpeg" data-width="683" data-height="320" src="https://cdn-images-1.medium.com/max/800/1*nrmZaiCa6lOkHQa_Xp5mQw.jpeg"></figure><p name="b7e5" id="b7e5" class="graf graf--p graf-after--figure">The fit() method takes the training data as arguments, which can be one array in the case of unsupervised learning, or two arrays in the case of supervised learning. Note that the model is fitted using X and y, but the object holds no reference to X and y. The predicted outcome of our actual test data is now named as test_yhat.</p><figure name="5508" id="5508" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1PduWHw-iwkas2M-H6xnTw.jpeg" data-width="683" data-height="386" src="https://cdn-images-1.medium.com/max/800/1*1PduWHw-iwkas2M-H6xnTw.jpeg"></figure><p name="1d7d" id="1d7d" class="graf graf--p graf-after--figure">The already downloaded <strong class="markup--strong markup--p-strong">sample submission</strong> file is loaded in and dubbed <strong class="markup--strong markup--p-strong">submission. </strong>It contains wrong values of the <strong class="markup--strong markup--p-strong">Item_Outlets_Sales.</strong></p><figure name="fd70" id="fd70" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HCIiymoMOnxbhd3Xspvcng.jpeg" data-width="683" data-height="432" src="https://cdn-images-1.medium.com/max/800/1*HCIiymoMOnxbhd3Xspvcng.jpeg"></figure><p name="eb96" id="eb96" class="graf graf--p graf-after--figure">The variable Item_Outlet_Sales of our submission file is then set to be equals to test_yhat.</p><p name="babd" id="babd" class="graf graf--p graf-after--p">Finally, Pandas <strong class="markup--strong markup--p-strong">to_csv() </strong>function converts our result into CSV data. We can pass a file object to write the CSV data into a file and we called the created file <strong class="markup--strong markup--p-strong">Mart.csv.</strong></p><p name="17d4" id="17d4" class="graf graf--p graf-after--p">You can then proceed to the submission page on DataHack platform.</p><figure name="096b" id="096b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*dtQtYS5vLOqh2kFnXSdSnw.jpeg" data-width="683" data-height="716" src="https://cdn-images-1.medium.com/max/800/1*dtQtYS5vLOqh2kFnXSdSnw.jpeg"></figure><p name="640d" id="640d" class="graf graf--p graf-after--figure">Yikes! We made a submission. <a href="https://drive.google.com/file/d/1-h2Ks6_o0RnSIEkEDltd2ZptdB43NizF/view?usp=drivesdk" data-href="https://drive.google.com/file/d/1-h2Ks6_o0RnSIEkEDltd2ZptdB43NizF/view?usp=drivesdk" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Here’s</a> the link to the full notebook.</p><p name="e0db" id="e0db" class="graf graf--p graf-after--p">Try working with better models to improve your score on the leaderboard.</p><p name="1011" id="1011" class="graf graf--p graf-after--p graf--trailing">Project-based learning is more efficient, more practical, and more fun. Not to forget, it is more hands-on allowing for more practical learning, rather than just concepts. Learn data science by doing. Happy Reading!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@precillieo" class="p-author h-card">Kolawole Precious</a> on <a href="https://medium.com/p/d57db4d1f4d7"><time class="dt-published" datetime="2020-08-09T04:35:51.751Z">August 9, 2020</time></a>.</p><p><a href="https://medium.com/@precillieo/bigmart-outlet-sales-prediction-d57db4d1f4d7" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 24, 2020.</p></footer></article></body></html>